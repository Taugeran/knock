filter:
((destination block) and (door blocks))

destination block:
(dst host IP or IP or IP)

door block:
((IP ACL block) and (sequence block))

IP ACL:
(src host or net or host or net)

sequence block:
((TCP block) or (UDP block))

TCP block:
(tcp dst port ##### or ##### and (TCP flag logic))

TCP flag logic:
(tcp[tcpflags] & [flags] != 0)

UDP block:
(udp dst port ##### or #####)

((dst host 192.168.255.99 or 172.16.234.155) and ((src host 192.168.255.88 or net 172.16.0.0/17) and (((tcp dst port 12345 or 23456) and (tcp[tcpflags & tcp-syn !=0])) or (udp dst port 456 or 19865))))
|[-----------------------------------------]-----[[--------------------------------------------]-----[[[---------------------------]-----[---------------------------]]----[-------------------------]]]|
|[-----------------------------------------]-----[[--------------------------------------------]-----[[[---------------------------]-----[---------------------------]]----[-------------------------]]]|
|[-----------------------------------------]-----[[--------------------------------------------]-----[[[--------[TCP ports]--------]-----[--------[TCP flags]--------]]----[-------------------------]]]|
|[-----------------------------------------]-----[[--------------------------------------------]-----[[--------------------------[TCP block]--------------------------]----[-------[UPD block]-------]]]|
|[-----------------------------------------]-----[[----------------[IP ACL]--------------------]-----[-----------------------------------------[port sequence]----------------------------------------]]|
|[------------[source block]---------------]-----[------------------------------------------------------[door block]-----------------------------------------------------------------------------------]|
|-----------------------------------------------------------------------------------------------[filter]------------------------------------------------------------------------------------------------|
